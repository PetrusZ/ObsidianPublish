<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>CS/Kubernetes on</title><link>https://obsidian.codeplayer.org/tags/CS/Kubernetes/</link><description>Recent content in CS/Kubernetes on</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><atom:link href="https://obsidian.codeplayer.org/tags/CS/Kubernetes/index.xml" rel="self" type="application/rss+xml"/><item><title>APIServer</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/APIServer/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/APIServer/</guid><description>API Server kube-apiserveræ˜¯Kubernetesæœ€é‡è¦çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œä¸»è¦æä¾›ä»¥ä¸‹çš„åŠŸèƒ½
æä¾›é›†ç¾¤ç®¡ç†çš„REST APIæ¥å£ï¼ŒåŒ…æ‹¬è®¤è¯æˆæƒã€æ•°æ®æ ¡éªŒä»¥åŠé›†ç¾¤çŠ¶æ€å˜æ›´ç­‰
æä¾›å…¶ä»–æ¨¡å—ä¹‹é—´çš„æ•°æ®äº¤äº’å’Œé€šä¿¡çš„æ¢çº½ï¼ˆå…¶ä»–æ¨¡å—é€šè¿‡API ServeræŸ¥è¯¢æˆ–ä¿®æ”¹æ•°æ®ï¼Œåªæœ‰API Serveræ‰ç›´æ¥æ“ä½œetcdï¼‰
è®¿é—®æ§åˆ¶æ¦‚è§ˆ Kubernetes APIçš„æ¯ä¸ªè¯·æ±‚éƒ½ä¼šç»è¿‡å¤šé˜¶æ®µçš„è®¿é—®æ§åˆ¶ä¹‹åæ‰ä¼šè¢«æ¥å—ï¼Œè¿™åŒ…æ‹¬è®¤è¯ã€æˆæƒä»¥åŠå‡†å…¥æ§åˆ¶ï¼ˆAdmission Controlï¼‰ç­‰ã€‚
è®¿é—®æ§åˆ¶ç»†èŠ‚ è®¤è¯ å¼€å¯TLSæ—¶ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½éœ€è¦é¦–å…ˆè®¤è¯ã€‚Kubernetesæ”¯æŒå¤šç§è®¤è¯æœºåˆ¶ï¼Œå¹¶æ”¯æŒåŒæ—¶å¼€å¯å¤šä¸ªè®¤è¯æ’ä»¶ï¼ˆåªè¦æœ‰ä¸€ä¸ªè®¤è¯é€šè¿‡å³å¯ï¼‰ã€‚å¦‚æœè®¤è¯æˆåŠŸï¼Œåˆ™ç”¨æˆ·çš„usernameä¼šä¼ å…¥æˆæƒæ¨¡å—åšè¿›ä¸€æ­¥æˆæƒéªŒè¯ï¼›è€Œå¯¹äºè®¤è¯å¤±è´¥çš„è¯·æ±‚åˆ™è¿”å›HTTP 401ã€‚
è®¤è¯æ’ä»¶ X509è¯ä¹¦ ä½¿ç”¨X509å®¢æˆ·ç«¯è¯ä¹¦åªéœ€è¦API Serverå¯åŠ¨æ—¶é…ç½®&amp;ndash;client-ca-file=SOMEFILEã€‚åœ¨è¯ä¹¦è®¤è¯æ—¶ï¼Œå…¶CNåŸŸç”¨ä½œç”¨æˆ·åï¼Œè€Œç»„ç»‡æœºæ„åŸŸåˆ™ç”¨ä½œgroupåã€‚ é™æ€Tokenæ–‡ä»¶ ä½¿ç”¨é™æ€Tokenæ–‡ä»¶è®¤è¯åªéœ€è¦API Serverå¯åŠ¨æ—¶é…ç½®&amp;ndash;token-auth-file=SOMEFILEã€‚ è¯¥æ–‡ä»¶ä¸ºcsvæ ¼å¼ï¼Œæ¯è¡Œè‡³å°‘åŒ…æ‹¬ä¸‰åˆ—token,username,user idï¼Œ token,user,uid,&amp;quot;group1,group2,group3â€ å¼•å¯¼Token ä¸ºäº†æ”¯æŒå¹³æ»‘åœ°å¯åŠ¨å¼•å¯¼æ–°çš„é›†ç¾¤ï¼ŒKubernetes åŒ…å«äº†ä¸€ç§åŠ¨æ€ç®¡ç†çš„æŒæœ‰è€…ä»¤ç‰Œç±»å‹ï¼Œ ç§°ä½œ å¯åŠ¨å¼•å¯¼ä»¤ç‰Œï¼ˆBootstrapTokenï¼‰ã€‚ è¿™äº›ä»¤ç‰Œä»¥ Secret çš„å½¢å¼ä¿å­˜åœ¨ kube-system åå­—ç©ºé—´ä¸­ï¼Œå¯ä»¥è¢«åŠ¨æ€ç®¡ç†å’Œåˆ›å»ºã€‚ æ§åˆ¶å™¨ç®¡ç†å™¨åŒ…å«çš„ TokenCleaner æ§åˆ¶å™¨èƒ½å¤Ÿåœ¨å¯åŠ¨å¼•å¯¼ä»¤ç‰Œè¿‡æœŸæ—¶å°†å…¶åˆ é™¤ã€‚ åœ¨ä½¿ç”¨kubeadméƒ¨ç½²Kubernetesæ—¶ï¼Œå¯é€šè¿‡kubeadm token listå‘½ä»¤æŸ¥è¯¢ã€‚ é™æ€å¯†ç æ–‡ä»¶ éœ€è¦API Serverå¯åŠ¨æ—¶é…ç½®&amp;ndash;basic-auth-file=SOMEFILEï¼Œæ–‡ä»¶æ ¼å¼ä¸ºcsvï¼Œæ¯è¡Œè‡³å°‘ä¸‰åˆ—password, user, uidï¼Œåé¢æ˜¯å¯é€‰çš„groupå password,user,uid,&amp;quot;group1,group2,group3â€ ServiceAccount ServiceAccountæ˜¯Kubernetesè‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå¹¶ä¼šè‡ªåŠ¨æŒ‚è½½åˆ°å®¹å™¨çš„/run/secrets/kubernetes.</description></item><item><title>CNI</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/CNI/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/CNI/</guid><description>CNI Kubernetes ç½‘ç»œæ¨¡å‹è®¾è®¡çš„åŸºç¡€åŸåˆ™æ˜¯ï¼š
æ‰€æœ‰çš„ Pod èƒ½å¤Ÿä¸é€šè¿‡ NATå°±èƒ½ç›¸äº’è®¿é—®ã€‚ æ‰€æœ‰çš„èŠ‚ç‚¹èƒ½å¤Ÿä¸é€šè¿‡NATå°±èƒ½ç›¸äº’è®¿é—®ã€‚ å®¹å™¨å†…çœ‹è§çš„ IPåœ°å€å’Œå¤–éƒ¨ç»„ä»¶çœ‹åˆ°çš„å®¹å™¨ IPæ˜¯ä¸€æ ·çš„ã€‚ Kubernetes çš„é›†ç¾¤é‡Œï¼ŒIPåœ°å€æ˜¯ä»¥ Podä¸ºå•ä½è¿›è¡Œåˆ†é…çš„ï¼Œæ¯ä¸ª Podéƒ½æ‹¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ IPåœ°å€ã€‚ä¸€ä¸ªPodå†…éƒ¨çš„æ‰€æœ‰å®¹å™¨å…±äº«ä¸€ä¸ªç½‘ç»œæ ˆï¼Œå³å®¿ä¸»æœºä¸Šçš„ä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„IP åœ°å€ã€ç½‘ç»œè®¾å¤‡ã€é…ç½®ç­‰éƒ½æ˜¯å…±äº«çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒPod é‡Œé¢çš„æ‰€æœ‰å®¹å™¨èƒ½é€šè¿‡localhost:portæ¥è¿æ¥å¯¹æ–¹ã€‚åœ¨Kubernetesä¸­ï¼Œæä¾›äº†ä¸€ä¸ªè½»é‡çš„é€šç”¨å®¹å™¨ç½‘ç»œæ¥å£ CNIï¼ˆContainer Network Interfaceï¼‰ï¼Œä¸“é—¨ç”¨äºè®¾ç½®å’Œåˆ é™¤å®¹å™¨çš„ç½‘ç»œè¿é€šæ€§ã€‚å®¹å™¨è¿è¡Œæ—¶é€šè¿‡ CNIè°ƒç”¨ç½‘ç»œæ’ä»¶æ¥å®Œæˆå®¹å™¨çš„ç½‘ç»œè®¾ç½®ã€‚</description></item><item><title>Controller Manager</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/Controller-Manager/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/Controller-Manager/</guid><description>æ§åˆ¶å™¨çš„å·¥ä½œæµç¨‹ Informer çš„å†…éƒ¨æœºåˆ¶ æ§åˆ¶å™¨çš„ååŒå·¥ä½œåŸç† é€šç”¨ Controller Job Controllerï¼šå¤„ç†jobã€‚
Pod AutoScalerï¼šå¤„ç† pod çš„è‡ªåŠ¨ç¼©å®¹/æ‰©å®¹ã€‚
RelicaSetï¼šä¾æ® Replicaset Spec åˆ›å»º Podã€‚</description></item><item><title>CRI</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/CRI/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/CRI/</guid><description>CRI å®¹å™¨è¿è¡Œæ—¶ï¼ˆContainer Runtimeï¼‰ï¼Œè¿è¡ŒäºKubernetesï¼ˆk8sï¼‰é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹ä¸­ï¼Œè´Ÿè´£å®¹å™¨çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚å…¶ä¸­ Docker æ˜¯ç›®å‰åº”ç”¨æœ€å¹¿çš„ã€‚éšç€å®¹å™¨äº‘çš„å‘å±•ï¼Œè¶Šæ¥è¶Šå¤šçš„å®¹å™¨è¿è¡Œæ—¶æ¶Œç°ã€‚ä¸ºäº†è§£å†³è¿™äº›å®¹å™¨è¿è¡Œæ—¶å’Œ Kubernetes çš„é›†æˆé—®é¢˜ï¼Œåœ¨ Kubernetes1.5ç‰ˆæœ¬ä¸­ï¼Œç¤¾åŒºæ¨å‡ºäº†CRIï¼ˆContainer Runtime Interfaceï¼Œå®¹å™¨è¿è¡Œæ—¶æ¥å£ï¼‰ä»¥æ”¯æŒæ›´å¤šçš„å®¹å™¨è¿è¡Œæ—¶ã€‚
CRIæ˜¯ Kuberneteså®šä¹‰çš„ä¸€ç»„ gRPCæœåŠ¡ã€‚kubeletä½œä¸ºå®¢æˆ·ç«¯ï¼ŒåŸºäºgRPCæ¡†æ¶ï¼Œé€šè¿‡ Socket å’Œå®¹å™¨è¿è¡Œæ—¶é€šä¿¡ã€‚ å®ƒåŒ…æ‹¬ä¸¤ç±»æœåŠ¡âˆ¶é•œåƒæœåŠ¡ï¼ˆImage Serviceï¼‰å’Œè¿è¡Œæ—¶æœåŠ¡ï¼ˆRuntime Serviceï¼‰ã€‚ é•œåƒæœåŠ¡æä¾›ä¸‹è½½ã€æ£€æŸ¥å’Œåˆ é™¤é•œåƒçš„è¿œç¨‹ç¨‹åºè°ƒç”¨ã€‚ è¿è¡Œæ—¶æœåŠ¡ åŒ…å«ç”¨äºç®¡ç†å®¹å™¨ç”Ÿå‘½å‘¨æœŸï¼Œä»¥åŠä¸å®¹å™¨äº¤äº’çš„è°ƒç”¨ï¼ˆexeC/ attach/ port-forwardï¼‰çš„è¿œç¨‹ç¨‹åºè°ƒç”¨ã€‚</description></item><item><title>CSI</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/CSI/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/CSI/</guid><description>å®¹å™¨è¿è¡Œæ—¶å­˜å‚¨ é™¤å¤–æŒ‚å­˜å‚¨å·å¤–ï¼Œå®¹å™¨å¯åŠ¨åï¼Œè¿è¡Œæ—¶æ‰€éœ€æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½ç›´æ¥å½±å“å®¹å™¨æ€§èƒ½ï¼›
æ—©æœŸçš„ Docker é‡‡ç”¨ Device Mapper ä½œä¸ºå®¹å™¨è¿è¡Œæ—¶å­˜å‚¨é©±åŠ¨ï¼Œå› ä¸º OverlayFSå°šæœªåˆå¹¶è¿›Kernelï¼›
ç›®å‰ Docker å’Œ containerdéƒ½é»˜è®¤ä»¥OverlayFS ä½œä¸ºè¿è¡Œæ—¶å­˜å‚¨é©±åŠ¨ï¼›
OverlayFSç›®å‰å·²ç»æœ‰éå¸¸å¥½çš„æ€§èƒ½ï¼Œä¸DeviceMapper ç›¸æ¯”ä¼˜ 20%ï¼Œä¸æ“ä½œä¸»æœºæ–‡ä»¶æ€§èƒ½å‡ ä¹ä¸€è‡´
å­˜å‚¨å·æ’ä»¶ç®¡ç† Kubernetesæ”¯æŒä»¥æ’ä»¶çš„å½¢å¼æ¥å®ç°å¯¹ä¸åŒå­˜å‚¨çš„æ”¯æŒå’Œæ‰©å±•ï¼Œè¿™äº›æ‰©å±•åŸºäºå¦‚ä¸‹ä¸‰ç§æ–¹å¼ï¼š
out-of-tree CSIæ’ä»¶ CSI é€šè¿‡ RPCä¸å­˜å‚¨é©±åŠ¨è¿›è¡Œäº¤äº’ã€‚</description></item><item><title>etcd</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/etcd/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/etcd/</guid><description>etcd Etcdæ˜¯CoreOSåŸºäºRaftå¼€å‘çš„åˆ†å¸ƒå¼key-valueå­˜å‚¨ï¼Œå¯ç”¨äºæœåŠ¡å‘ç°ã€å…±äº«é…ç½®ä»¥åŠä¸€è‡´æ€§ä¿éšœï¼ˆå¦‚æ•°æ®åº“é€‰ä¸»ã€åˆ†å¸ƒå¼é”ç­‰ï¼‰ã€‚
åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¦‚ä½•ç®¡ç†èŠ‚ç‚¹é—´çš„çŠ¶æ€ä¸€ç›´æ˜¯ä¸€ä¸ªéš¾é¢˜ï¼Œetcdåƒæ˜¯ä¸“é—¨ä¸ºé›†ç¾¤ç¯å¢ƒçš„æœåŠ¡å‘ç°å’Œæ³¨å†Œè€Œè®¾è®¡ï¼Œå®ƒæä¾›äº†æ•°æ®TTLå¤±æ•ˆã€æ•°æ®æ”¹å˜ç›‘è§†ã€å¤šå€¼ã€ç›®å½•ç›‘å¬ã€åˆ†å¸ƒå¼é”åŸå­æ“ä½œç­‰åŠŸèƒ½ï¼Œå¯ä»¥æ–¹ä¾¿çš„è·Ÿè¸ªå¹¶ç®¡ç†é›†ç¾¤èŠ‚ç‚¹çš„çŠ¶æ€ã€‚
é”®å€¼å¯¹å­˜å‚¨ï¼šå°†æ•°æ®å­˜å‚¨åœ¨åˆ†å±‚ç»„ç»‡çš„ç›®å½•ä¸­ï¼Œå¦‚åŒåœ¨æ ‡å‡†æ–‡ä»¶ç³»ç»Ÿä¸­ ç›‘æµ‹å˜æ›´ï¼šç›‘æµ‹ç‰¹å®šçš„é”®æˆ–ç›®å½•ä»¥è¿›è¡Œæ›´æ”¹ï¼Œå¹¶å¯¹å€¼çš„æ›´æ”¹åšå‡ºååº” ç®€å•: curlå¯è®¿é—®çš„ç”¨æˆ·çš„APIï¼ˆHTTP+JSONï¼‰ å®‰å…¨: å¯é€‰çš„SSLå®¢æˆ·ç«¯è¯ä¹¦è®¤è¯ å¿«é€Ÿ: å•å®ä¾‹æ¯ç§’1000æ¬¡å†™æ“ä½œï¼Œ2000+æ¬¡è¯»æ“ä½œ å¯é : ä½¿ç”¨Raftç®—æ³•ä¿è¯ä¸€è‡´æ€§ ä¸»è¦åŠŸèƒ½ åŸºæœ¬çš„key-valueå­˜å‚¨ ç›‘å¬æœºåˆ¶ keyçš„è¿‡æœŸåŠç»­çº¦æœºåˆ¶ï¼Œç”¨äºç›‘æ§å’ŒæœåŠ¡å‘ç° åŸå­Compare And Swapå’ŒCompare And Deleteï¼Œç”¨äºåˆ†å¸ƒå¼é”å’Œleaderé€‰ä¸¾ ä½¿ç”¨åœºæ™¯ ä¹Ÿå¯ä»¥ç”¨äºé”®å€¼å¯¹å­˜å‚¨ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥è¯»å–å’Œå†™å…¥ etcd ä¸­çš„æ•°æ® etcd æ¯”è¾ƒå¤šçš„åº”ç”¨åœºæ™¯æ˜¯ç”¨äºæœåŠ¡æ³¨å†Œä¸å‘ç° åŸºäºç›‘å¬æœºåˆ¶çš„åˆ†å¸ƒå¼å¼‚æ­¥ç³»ç»Ÿ é”®å€¼å¯¹å­˜å‚¨ etcd æ˜¯ä¸€ä¸ªé”®å€¼å­˜å‚¨çš„ç»„ä»¶ï¼Œå…¶ä»–çš„åº”ç”¨éƒ½æ˜¯åŸºäºå…¶é”®å€¼å­˜å‚¨çš„åŠŸèƒ½å±•å¼€ã€‚</description></item><item><title>Headless</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/Headless/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/Headless/</guid><description>Headlesså’ŒClusterIPçš„åŒºåˆ« CoreDNSçš„ä½œç”¨ï¼šåœ¨K8Sé‡Œï¼Œæˆ‘ä»¬æƒ³è¦é€šè¿‡nameæ¥è®¿é—®æœåŠ¡çš„æ–¹å¼å°±æ˜¯åœ¨Deploymentä¸Šé¢æ·»åŠ ä¸€å±‚Serviceï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡Service nameæ¥è®¿é—®æœåŠ¡äº†ï¼Œé‚£å…¶ä¸­çš„åŸç†å°±æ˜¯å’ŒCoreDNSæœ‰å…³ï¼Œå®ƒå°†Service nameè§£ææˆCluster IPã€‚
è¿™æ ·æˆ‘ä»¬è®¿é—®Cluster IPçš„æ—¶å€™å°±é€šè¿‡Cluster IPä½œè´Ÿè½½å‡è¡¡ï¼ŒæŠŠæµé‡åˆ†å¸ƒåˆ°å„ä¸ªPODä¸Šé¢ã€‚
K8sä¸­èµ„æºçš„å…¨å±€FQDNæ ¼å¼:
1 2 Service_NAME.NameSpace_NAME.Domain.LTD. Domain.LTD.=svc.cluster.local.ã€€#è¿™æ˜¯é»˜è®¤k8sé›†ç¾¤çš„åŸŸåã€‚ ClusterIP ClusterIPçš„åŸç†ï¼šä¸€ä¸ªServiceå¯èƒ½å¯¹åº”å¤šä¸ªEndPoint(Pod)ï¼Œclientè®¿é—®çš„æ˜¯Cluster IPï¼Œé€šè¿‡iptablesè§„åˆ™è½¬åˆ°Real Serverï¼Œä»è€Œè¾¾åˆ°è´Ÿè½½å‡è¡¡çš„æ•ˆæœã€‚</description></item><item><title>istio</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/istio/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/istio/</guid><description>é—®é¢˜ No tracingé—®é¢˜ æ²¡æœ‰æ­£ç¡®è®¾ç½®meshConfig.defaultConfig.tracing.zipkin.addresså’ŒmeshConfig.defaultConfig.tracing.sampling istioctl install --set profile=demo --set meshConfig.defaultConfig.tracing.zipkin.address=jaeger-collector.istio-system:9411 --set meshConfig.defaultConfig.tracing.sampling=100 -y é‡å»ºã€æ›´æ–°istioåï¼Œå¯èƒ½éœ€è¦æŠŠsidecaré‡å¯/é‡å»º jaegeræš‚æ—¶ä½¿ç”¨allinoneå³å¯ï¼Œå› ä¸ºç”¨esåšåç«¯å­˜å‚¨å¤ªéš¾é…ç½® kialiçš„Graphä¸ºç©ºæˆ–prometheusæ²¡æœ‰æ•°æ® prometheus.</description></item><item><title>K0S</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/K0S/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/K0S/</guid><description>å®‰è£…K0S https://docs.k0sproject.io/v1.23.6+k0s.2/install/
curl -sSLf [https://get.k0s.sh](https://get.k0s.sh) | sudo sh sudo k0s install controller --single sudo k0s start sudo k0s status sudo k0s kubectl get nodes å¸è½½K0S sudo k0s stop sudo k0s reset reboot system ğŸ’¡ A few small k0s fragments persist even after the reset (for example, iptables).</description></item><item><title>kube-proxy</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/kube-proxy/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/kube-proxy/</guid><description>kube-proxy æ¯å°æœºå™¨ä¸Šéƒ½è¿è¡Œä¸€ä¸ªkube-proxyæœåŠ¡ï¼Œå®ƒç›‘å¬API serverä¸­serviceå’Œendpointçš„å˜åŒ–æƒ…å†µï¼Œå¹¶é€šè¿‡iptablesç­‰æ¥ä¸ºæœåŠ¡é…ç½®è´Ÿè½½å‡è¡¡ï¼ˆä»…æ”¯æŒTCPå’ŒUDPï¼‰ã€‚
kube-proxyå¯ä»¥ç›´æ¥è¿è¡Œåœ¨ç‰©ç†æœºä¸Šï¼Œä¹Ÿå¯ä»¥ä»¥static podæˆ–è€…DaemonSetçš„æ–¹å¼è¿è¡Œã€‚
kube-proxyå½“å‰æ”¯æŒä¸€ä¸‹å‡ ç§å®ç°
userspaceï¼šæœ€æ—©çš„è´Ÿè½½å‡è¡¡æ–¹æ¡ˆï¼Œå®ƒåœ¨ç”¨æˆ·ç©ºé—´ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ‰€æœ‰æœåŠ¡é€šè¿‡iptablesè½¬å‘åˆ°è¿™ä¸ªç«¯å£ï¼Œç„¶ååœ¨å…¶å†…éƒ¨è´Ÿè½½å‡è¡¡åˆ°å®é™…çš„Podã€‚è¯¥æ–¹å¼æœ€ä¸»è¦çš„é—®é¢˜æ˜¯æ•ˆç‡ä½ï¼Œæœ‰æ˜æ˜¾çš„æ€§èƒ½ç“¶é¢ˆã€‚ iptablesï¼šç›®å‰æ¨èçš„æ–¹æ¡ˆï¼Œå®Œå…¨ä»¥iptablesè§„åˆ™çš„æ–¹å¼æ¥å®ç°serviceè´Ÿè½½å‡è¡¡ã€‚è¯¥æ–¹å¼æœ€ä¸»è¦çš„é—®é¢˜æ˜¯åœ¨æœåŠ¡å¤šçš„æ—¶å€™äº§ç”Ÿå¤ªå¤šçš„iptablesè§„åˆ™ï¼Œéå¢é‡å¼æ›´æ–°ä¼šå¼•å…¥ä¸€å®šçš„æ—¶å»¶ï¼Œå¤§è§„æ¨¡æƒ…å†µä¸‹æœ‰æ˜æ˜¾çš„æ€§èƒ½é—®é¢˜ ipvsï¼šä¸ºè§£å†³iptablesæ¨¡å¼çš„æ€§èƒ½é—®é¢˜ï¼Œv1.8æ–°å¢äº†ipvsæ¨¡å¼ï¼Œé‡‡ç”¨å¢é‡å¼æ›´æ–°ï¼Œå¹¶å¯ä»¥ä¿è¯serviceæ›´æ–°æœŸé—´è¿æ¥ä¿æŒä¸æ–­å¼€ winuserspaceâˆ¶ åŒuserspaceï¼Œä½†ä»…å·¥ä½œåœ¨windowsä¸Š Linuxå†…æ ¸å¤„ç†æ•°æ®åŒ…ï¼šNetfilteræ¡†æ¶ Netfilterå’Œiptables iptables iptablesæ”¯æŒçš„é”šç‚¹ kube-proxyå·¥ä½œåŸç† Kubernetes iptablesè§„åˆ™ IPVS IPVSæ”¯æŒçš„é”šç‚¹å’Œæ ¸å¿ƒå‡½æ•° åŸŸåæœåŠ¡ Kubernetes Serviceé€šè¿‡è™šæ‹ŸIPåœ°å€æˆ–è€…èŠ‚ç‚¹ç«¯å£ä¸ºç”¨æˆ·åº”ç”¨æä¾›è®¿é—®å…¥å£</description></item><item><title>Kubelet</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/Kubelet/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/Kubelet/</guid><description>kubelet æ¶æ„ kubelet ç®¡ç† Pod çš„æ ¸å¿ƒæµç¨‹ kubelet æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œä¸€ä¸ªkubelet æœåŠ¡è¿›ç¨‹ï¼Œé»˜è®¤ç›‘å¬ 10250ç«¯å£ã€‚
æ¥æ”¶å¹¶æ‰§è¡Œ master å‘æ¥çš„æŒ‡ä»¤ï¼› ç®¡ç† PodåŠPod ä¸­çš„å®¹å™¨ï¼› æ¯ä¸ªkubelet è¿›ç¨‹ä¼šåœ¨API Server ä¸Šæ³¨å†ŒèŠ‚ç‚¹è‡ªèº«ä¿¡æ¯ï¼Œå®šæœŸå‘ master èŠ‚ç‚¹æ±‡æŠ¥èŠ‚ç‚¹çš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œå¹¶é€šè¿‡ cAdvisorç›‘æ§èŠ‚ç‚¹å’Œå®¹å™¨çš„èµ„æºã€‚ èŠ‚ç‚¹ç®¡ç† èŠ‚ç‚¹ç®¡ç†ä¸»è¦æ˜¯èŠ‚ç‚¹è‡ªæ³¨å†Œå’ŒèŠ‚ç‚¹çŠ¶æ€æ›´æ–°ï¼š</description></item><item><title>Service</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/Service/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/Service/</guid><description>Serviceå¯¹è±¡ Service Selector Kuberneteså…è®¸å°†Podå¯¹è±¡é€šè¿‡æ ‡ç­¾ï¼ˆLabelï¼‰è¿›è¡Œæ ‡è®°ï¼Œå¹¶é€šè¿‡Service Selectorå®šä¹‰åŸºäºPodæ ‡ç­¾çš„è¿‡æ»¤è§„åˆ™ï¼Œä»¥ä¾¿é€‰æ‹©æœåŠ¡çš„ä¸Šæ¸¸åº”ç”¨å®ä¾‹ Ports Portså±æ€§ä¸­å®šä¹‰äº†æœåŠ¡çš„ç«¯å£ã€åè®®ç›®æ ‡ç«¯å£ç­‰ä¿¡æ¯ 1 2 3 4 5 6 7 8 9 10 11 apiVersion:v1kind:Servicemetadata:name:nginx-serviceSpec:selector:app:nginxports:- protocol:TCPport:80targetPort:80 Endpointå¯¹è±¡ å½“Serviceçš„selectorä¸ä¸ºç©ºæ—¶ï¼ŒKubernetes EndpointControllerä¼šä¾¦å¬æœåŠ¡åˆ›å»ºäº‹ä»¶ï¼Œåˆ›å»ºä¸ServiceåŒåçš„Endpointå¯¹è±¡ selectorèƒ½å¤Ÿé€‰å–çš„æ‰€æœ‰PodIPéƒ½ä¼šè¢«é…ç½®åˆ°addresseså±æ€§ä¸­ å¦‚æœæ­¤æ—¶selectoræ‰€å¯¹åº”çš„filteræŸ¥è¯¢ä¸åˆ°å¯¹åº”çš„Podï¼Œåˆ™addressesåˆ—è¡¨ä¸ºç©º é»˜è®¤é…ç½®ä¸‹ï¼Œå¦‚æœæ­¤æ—¶å¯¹åº”çš„Podä¸ºnot readyçŠ¶æ€ï¼Œåˆ™å¯¹åº”çš„PodIPåªä¼šå‡ºç°åœ¨subsetsçš„notReadyAddresseså±æ€§ä¸­ï¼Œè¿™æ„å‘³ç€å¯¹åº”çš„Podè¿˜æ²¡å‡†å¤‡å¥½æä¾›æœåŠ¡ï¼Œä¸èƒ½ä½œä¸ºæµé‡è½¬å‘çš„ç›®æ ‡ã€‚ å¦‚æœè®¾ç½®äº†PublishNotReadyAdddressä¸ºtrueï¼Œåˆ™æ— è®ºPodæ˜¯å¦å°±ç»ªéƒ½ä¼šè¢«åŠ å…¥readyAddress list 1 2 3 4 5 6 7 8 9 10 11 12 13 14 apiVersion:v1kind:Endpointmetadata:name:nginx-servicesubsets:- addresses:- ip:10.</description></item><item><title>åŸºäºIstioçš„é«˜çº§æµé‡ç®¡ç†</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E5%9F%BA%E4%BA%8EIstio%E7%9A%84%E9%AB%98%E7%BA%A7%E6%B5%81%E9%87%8F%E7%AE%A1%E7%90%86/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E5%9F%BA%E4%BA%8EIstio%E7%9A%84%E9%AB%98%E7%BA%A7%E6%B5%81%E9%87%8F%E7%AE%A1%E7%90%86/</guid><description>å¾®æœåŠ¡æ¶æ„çš„æ¼”å˜ Evolution ä»å•å—ç³»ç»Ÿåˆ°å¾®æœåŠ¡ç³»ç»Ÿçš„æ¼”è¿› å¾®æœåŠ¡æ¶æ„çš„æ¼”è¿› å…¸å‹çš„å¾®æœåŠ¡ä¸šåŠ¡åœºæ™¯ æ›´å®Œæ•´çš„å¾®æœåŠ¡æ¶æ„ ç³»ç»Ÿè¾¹ç•Œ å¾®æœåŠ¡åˆ°æœåŠ¡ç½‘æ ¼è¿˜ç¼ºä»€ä¹ˆ? Sidecar çš„å·¥ä½œåŸç† Service Mesh é€‚åº”æ€§</description></item><item><title>åŸºäºKuberneteså’ŒIstioçš„å®‰å…¨ä¿è¯</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E5%9F%BA%E4%BA%8EKubernetes%E5%92%8CIstio%E7%9A%84%E5%AE%89%E5%85%A8%E4%BF%9D%E8%AF%81/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E5%9F%BA%E4%BA%8EKubernetes%E5%92%8CIstio%E7%9A%84%E5%AE%89%E5%85%A8%E4%BF%9D%E8%AF%81/</guid><description>äº‘åŸç”Ÿè¯­å¢ƒä¸‹çš„å®‰å…¨ä¿è¯ äº‘åŸç”Ÿè¯­å¢ƒä¸‹çš„å®‰å…¨ä¿è¯ å®‰å…¨ä¿è¯æ˜¯è´¯ç©¿è½¯ä»¶æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„é‡è¦éƒ¨åˆ†ã€‚
å®‰å…¨ä¸æ•ˆç‡æœ‰æ—¶å€™æ˜¯ç›¸è¿èƒŒçš„ã€‚
å¦‚ä½•å°†äºŒè€…ç»Ÿä¸€èµ·æ¥ï¼Œæå‡æ•´ä½“æ•ˆç‡æ˜¯å…³é”®ã€‚
è¿™éœ€è¦æˆ‘ä»¬å°†å®‰å…¨æ€æƒ³è´¯ç©¿åˆ°è½¯ä»¶å¼€å‘è¿ç»´çš„æ‰€æœ‰ç¯èŠ‚ã€‚
äº‘åŸç”Ÿå±‚æ¬¡æ¨¡å‹ è½¯ä»¶çš„ç”Ÿå‘½å‘¨æœŸâˆ¶å¼€å‘-&amp;gt;åˆ†å‘â†’éƒ¨ç½²-&amp;gt;è¿è¡Œ
å¼€å‘ç¯èŠ‚çš„å®‰å…¨ä¿è¯ SaaS åº”ç”¨çš„ [[ç³»ç»Ÿæ¶æ„#12 factors|12-factor]] è®¾è®¡åŸåˆ™çš„ä¸€äº›ç†å¿µä¸äº‘åŸç”Ÿå®‰å…¨ä¸è°‹è€Œåˆã€‚
ä¼ ç»Ÿçš„å®‰å…¨ä¸‰å…ƒç´  CIAï¼ˆConfidentialitVIntegrityå’Œ AVailabilityï¼‰ï¼Œåœ¨äº‘åŸç”Ÿå®‰å…¨ä¸­è¢«å……åˆ†åº”ç”¨ï¼Œå¦‚å¯¹å·¥ä½œè´Ÿè½½çš„å®Œæ•´æ€§ä¿æŠ¤ï¼Œä¸Iï¼ˆIntegrityï¼‰å®Œæ•´æ€§ä¿æŠ¤ç›¸å¯¹åº”ã€‚
æœºå¯†æ€§ï¼ˆConfidentialityï¼‰æŒ‡åªæœ‰æˆæƒç”¨æˆ·å¯ä»¥è·å–ä¿¡æ¯ã€‚ å®Œæ•´æ€§ï¼ˆIntegrityï¼‰æŒ‡ä¿¡æ¯åœ¨è¾“å…¥å’Œä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼Œä¸è¢«éæ³•æˆæƒä¿®æ”¹å’Œç ´åï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚ å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰æŒ‡ä¿è¯åˆæ³•ç”¨æˆ·å¯¹ä¿¡æ¯å’Œèµ„æºçš„ä½¿ç”¨ä¸ä¼šè¢«ä¸æ­£å½“åœ°æ‹’ç»ã€‚ **åŸºç¡€è®¾æ–½å³ä»£ç ï¼ˆInfrastructure as Codeï¼Œç®€ç§° laCï¼‰**ä¹Ÿä¸äº‘åŸç”Ÿçš„å®è·µç´§å¯†ç›¸å…³ã€‚</description></item><item><title>å°†åº”ç”¨è¿ç§»è‡³Kuberneteså¹³å°</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E5%B0%86%E5%BA%94%E7%94%A8%E8%BF%81%E7%A7%BB%E8%87%B3Kubernetes%E5%B9%B3%E5%8F%B0/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E5%B0%86%E5%BA%94%E7%94%A8%E8%BF%81%E7%A7%BB%E8%87%B3Kubernetes%E5%B9%B3%E5%8F%B0/</guid><description>åº”ç”¨æ¥å…¥æœ€ä½³å®è·µ åº”ç”¨å®¹å™¨åŒ– ç›®æ ‡ ç¨³å®šæ€§ã€å¯ç”¨æ€§ã€æ€§èƒ½ã€å®‰å…¨
ä»å¤šç»´åº¦æ€è€ƒé«˜å¯ç”¨çš„é—®é¢˜
åº”ç”¨å®¹å™¨åŒ–çš„æ€è€ƒ å®¹å™¨é¢å¤–å¼€é”€å’Œé£é™© Log driver Blocking mode Non blocking mode å…±ç”¨ kernel æ‰€ä»¥ ç³»ç»Ÿå‚æ•°é…ç½®å…±äº« è¿›ç¨‹æ•°å…±äº«-Fork bomb fd æ•°å…±äº« ä¸»æœºç£ç›˜å…±äº« å®¹å™¨åŒ–åº”ç”¨çš„èµ„æºç›‘æ§ å®¹å™¨ä¸­çœ‹åˆ°çš„èµ„æºæ˜¯ä¸»æœºèµ„æº</description></item><item><title>å¸¸ç”¨å‘½ä»¤</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</guid><description>Kubectl Kubectl å‘½ä»¤å’Œ kubeconfig kubectl æ˜¯ä¸€ä¸ª Kubernetes çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒå…è®¸Kubernetes ç”¨æˆ·ä»¥å‘½ä»¤è¡Œçš„æ–¹å¼ä¸ Kubernetes äº¤äº’ï¼Œå…¶é»˜è®¤è¯»å–é…ç½®æ–‡ä»¶ ~/.kube/configã€‚ kubectl ä¼šå°†æ¥æ”¶åˆ°çš„ç”¨æˆ·è¯·æ±‚è½¬åŒ–ä¸º rest è°ƒç”¨ä»¥rest client çš„å½¢å¼ä¸ apiserver é€šè®¯ã€‚ apiserver çš„åœ°å€ï¼Œç”¨æˆ·ä¿¡æ¯ç­‰é…ç½®åœ¨ kubeconfigã€‚ å¸¸ç”¨å‘½ä»¤ kubectl get po â€“oyaml -w kubectl å¯æŸ¥çœ‹å¯¹è±¡ã€‚ -oyaml è¾“å‡ºè¯¦ç»†ä¿¡æ¯ä¸º yaml æ ¼å¼ã€‚ -w watch è¯¥å¯¹è±¡çš„åç»­å˜åŒ–ã€‚ -owide ä»¥è¯¦ç»†åˆ—è¡¨çš„æ ¼å¼æŸ¥çœ‹å¯¹è±¡ã€‚ åœ¨ç»ˆç«¯é€šè¿‡stdinè¯»å–inline YAML 1 2 3 4 $ kubectl apply -f - &amp;lt;&amp;lt;EOF &amp;lt;-- insert YAML content here --&amp;gt; EOF OR</description></item><item><title>æœåŠ¡å‘ç°</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/</guid><description>æœåŠ¡å‘å¸ƒ éœ€è¦æŠŠæœåŠ¡å‘å¸ƒè‡³é›†ç¾¤å†…éƒ¨æˆ–è€…å¤–éƒ¨ï¼ŒæœåŠ¡çš„ä¸åŒç±»å‹ ClusterlP(Headless) NodePort LoadBalancer ExternalName è¯ä¹¦ç®¡ç†å’Œä¸ƒå±‚è´Ÿè½½å‡è¡¡çš„éœ€æ±‚ éœ€è¦gRPCè´Ÿè½½å‡è¡¡å¦‚ä½•åš? DNSéœ€æ±‚ ä¸ä¸Šä¸‹æ¸¸æœåŠ¡çš„å…³ç³» æœåŠ¡å‘å¸ƒçš„æŒ‘æˆ˜ kube-dns DNS TTLé—®é¢˜ Service ClusterIPåªèƒ½å¯¹å†… kube-proxyæ”¯æŒçš„iptables/ipvsè§„æ¨¡æœ‰é™ IPVSçš„æ€§èƒ½å’Œç”Ÿäº§åŒ–é—®é¢˜ kube-proxyçš„drifté—®é¢˜ é¢‘ç¹çš„Podå˜åŠ¨ï¼ˆspec changeï¼Œfailoverï¼Œcrashloopï¼‰å¯¼è‡´LBé¢‘ç¹å˜æ›´ å¯¹å¤–å‘å¸ƒçš„Serviceéœ€è¦ä¸ä¼ä¸šELBå³æˆ ä¸æ”¯æŒgRPC ä¸æ”¯æŒè‡ªå®šä¹‰DNSå’Œé«˜çº§è·¯ç”±åŠŸèƒ½ Ingress Specçš„æˆç†Ÿåº¦?</description></item><item><title>æ¶æ„åŸºç¡€</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E6%9E%B6%E6%9E%84%E5%9F%BA%E7%A1%80/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E6%9E%B6%E6%9E%84%E5%9F%BA%E7%A1%80/</guid><description>ä¸»è¦ç»„ä»¶ Kubernetes çš„ä¸»èŠ‚ç‚¹ï¼ˆMaster Nodeï¼‰ APIæœåŠ¡å™¨ï¼šAPI Server è¿™æ˜¯ Kubernetes æ§åˆ¶é¢æ¿ä¸­å”¯ä¸€å¸¦æœ‰ç”¨æˆ·å¯è®¿é—® API ä»¥åŠç”¨æˆ·å¯äº¤äº’çš„ç»„ä»¶ã€‚API æœåŠ¡å™¨ä¼šæš´éœ²ä¸€ä¸ª RESTful çš„ Kubernetes API å¹¶ä½¿ç”¨ JSON æ ¼å¼çš„æ¸…å•æ–‡ä»¶ï¼ˆmanifest filesï¼‰ã€‚ ç¾¤çš„æ•°æ®å­˜å‚¨ï¼šCluster Data Store Kubernetes ä½¿ç”¨â€œetcdâ€ã€‚è¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ã€ç¨³å®šçš„ã€é«˜å¯ç”¨çš„é”®å€¼å­˜å‚¨ï¼Œè¢«Kubernetes ç”¨äºé•¿ä¹…å‚¨å­˜æ‰€æœ‰çš„ API å¯¹è±¡ã€‚ æ§åˆ¶ç®¡ç†å™¨ï¼šController Manager è¢«ç§°ä¸ºâ€œkube-controller managerâ€ï¼Œå®ƒè¿è¡Œç€æ‰€æœ‰å¤„ç†é›†ç¾¤æ—¥å¸¸ä»»åŠ¡çš„æ§åˆ¶å™¨ã€‚åŒ…æ‹¬äº†èŠ‚ç‚¹æ§åˆ¶å™¨ã€å‰¯æœ¬æ§åˆ¶å™¨ã€ç«¯ç‚¹ï¼ˆendpointï¼‰æ§åˆ¶å™¨ä»¥åŠæœåŠ¡è´¦æˆ·ç­‰ã€‚ è°ƒåº¦å™¨ï¼šScheduler è°ƒåº¦å™¨ä¼šç›‘æ§æ–°å»ºçš„ podsï¼ˆä¸€ç»„æˆ–ä¸€ä¸ªå®¹å™¨ï¼‰å¹¶å°†å…¶åˆ†é…ç»™èŠ‚ç‚¹ã€‚ Kubernetes çš„å·¥ä½œèŠ‚ç‚¹ï¼ˆWorker Nodeï¼‰ Kubelet è´Ÿè´£è°ƒåº¦åˆ°å¯¹åº”èŠ‚ç‚¹çš„ Pod çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œæ‰§è¡Œä»»åŠ¡å¹¶å°† Pod çŠ¶æ€æŠ¥å‘Šç»™ä¸»èŠ‚ç‚¹çš„æ¸ é“ï¼Œé€šè¿‡å®¹å™¨è¿è¡Œæ—¶ï¼ˆæ‹‰å–é•œåƒã€å¯åŠ¨å’Œåœæ­¢å®¹å™¨ç­‰ï¼‰æ¥è¿è¡Œè¿™äº›å®¹å™¨ã€‚å®ƒè¿˜ä¼šå®šæœŸæ‰§è¡Œè¢«è¯·æ±‚çš„å®¹å™¨çš„å¥åº·æ¢æµ‹ç¨‹åºã€‚ Kube-proxy å®ƒè´Ÿè´£èŠ‚ç‚¹çš„ç½‘ç»œï¼Œåœ¨ä¸»æœºä¸Šç»´æŠ¤ç½‘ç»œè§„åˆ™å¹¶æ‰§è¡Œè¿æ¥è½¬å‘ã€‚å®ƒè¿˜è´Ÿè´£å¯¹æ­£åœ¨æœåŠ¡çš„ pods è¿›è¡Œè´Ÿè½½å¹³è¡¡ã€‚ etcd etcd æ˜¯ CoreOS åŸºäº Raft å¼€å‘çš„åˆ†å¸ƒå¼ key-value å­˜å‚¨ï¼Œå¯ç”¨äºæœåŠ¡å‘ç°ã€å…±äº«é…ç½®ä»¥åŠä¸€è‡´æ€§ä¿éšœï¼ˆå¦‚æ•°æ®åº“é€‰ä¸»ã€åˆ†å¸ƒå¼é”ç­‰ï¼‰ã€‚</description></item><item><title>æ·±å…¥ç†è§£</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/</guid><description>API è®¾è®¡åŸåˆ™ æ‰€æœ‰ API éƒ½åº”æ˜¯å£°æ˜å¼çš„
ç›¸å¯¹äºå‘½ä»¤å¼æ“ä½œï¼Œå£°æ˜å¼æ“ä½œå¯¹äºé‡å¤æ“ä½œçš„æ•ˆæœæ˜¯ç¨³å®šçš„ï¼Œè¿™å¯¹äºå®¹æ˜“å‡ºç°æ•°æ®ä¸¢å¤±æˆ–é‡å¤çš„åˆ†å¸ƒå¼ç¯å¢ƒæ¥è¯´æ˜¯å¾ˆé‡è¦çš„ã€‚
å£°æ˜å¼æ“ä½œæ›´æ˜“è¢«ç”¨æˆ·ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç³»ç»Ÿå‘ç”¨æˆ·éšè—å®ç°çš„ç»†èŠ‚ï¼ŒåŒæ—¶ä¹Ÿä¿ç•™äº†ç³»ç»Ÿæœªæ¥æŒç»­ä¼˜åŒ–çš„å¯èƒ½æ€§ã€‚
æ­¤å¤–ï¼Œå£°æ˜å¼çš„ API è¿˜éšå«äº†æ‰€æœ‰çš„ API å¯¹è±¡éƒ½æ˜¯åè¯æ€§è´¨çš„ï¼Œä¾‹å¦‚ Serviceã€Volume è¿™äº› API éƒ½æ˜¯åè¯ï¼Œè¿™äº›åè¯æè¿°äº†ç”¨æˆ·æ‰€
æœŸæœ›å¾—åˆ°çš„ä¸€ä¸ªç›®æ ‡å¯¹è±¡ã€‚
API å¯¹è±¡æ˜¯å½¼æ­¤äº’è¡¥è€Œä¸”å¯ç»„åˆçš„
è¿™å®é™…ä¸Šé¼“åŠ± API å¯¹è±¡å°½é‡å®ç°é¢å‘å¯¹è±¡è®¾è®¡æ—¶çš„è¦æ±‚ï¼Œå³â€œé«˜å†…èšï¼Œæ¾è€¦åˆâ€ï¼Œå¯¹ä¸šåŠ¡ç›¸å…³çš„æ¦‚å¿µæœ‰ä¸€ä¸ªåˆé€‚çš„åˆ†è§£ï¼Œæé«˜åˆ†è§£å‡ºæ¥çš„å¯¹è±¡çš„å¯é‡ç”¨æ€§ã€‚</description></item><item><title>æ·±å…¥ç†è§£Podçš„ç”Ÿå‘½å‘¨æœŸ</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pod%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pod%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</guid><description>å¦‚ä½•ä¼˜é›…çš„ç®¡ç†Podçš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ PodçŠ¶æ€æœº Pod Phase Pod Phase Pending Running Succeeded Failed Unknown kubectl get podæ˜¾ç¤ºçš„çŠ¶æ€ä¿¡æ¯æ˜¯ç”±podstatus çš„conditionså’Œphaseè®¡ç®—å‡ºæ¥çš„ æŸ¥çœ‹podç»†èŠ‚ kubectl get pod $podname-oyaml æŸ¥çœ‹podç›¸å…³äº‹ä»¶ kubectl describe pod PodçŠ¶æ€è®¡ç®—ç»†èŠ‚ å¦‚ä½•ç¡®ä¿Podçš„é«˜å¯ç”¨ é¿å…å®¹å™¨è¿›ç¨‹è¢«ç»ˆæ­¢é¿å…Podè¢«é©±é€</description></item><item><title>ç”Ÿäº§åŒ–è¿ç»´</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E7%94%9F%E4%BA%A7%E5%8C%96%E8%BF%90%E7%BB%B4/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E7%94%9F%E4%BA%A7%E5%8C%96%E8%BF%90%E7%BB%B4/</guid><description>é•œåƒä»“åº“ é•œåƒä»“åº“ é•œåƒä»“åº“ï¼ˆDocker Registryï¼‰è´Ÿè´£å­˜å‚¨ã€ç®¡ç†å’Œåˆ†å‘é•œåƒã€‚ é•œåƒä»“åº“ç®¡ç†å¤šä¸ªRepositoryï¼ŒRepositoryé€šè¿‡å‘½åæ¥åŒºåˆ†ã€‚æ¯ä¸ªRepositoryåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒï¼Œé•œåƒé€šè¿‡é•œåƒåç§°å’Œæ ‡ç­¾ï¼ˆTagï¼‰æ¥åŒºåˆ†ã€‚ å®¢æˆ·ç«¯æ‹‰å–é•œåƒæ—¶ï¼Œè¦æŒ‡å®šä¸‰è¦ç´ ï¼š é•œåƒä»“åº“ï¼šè¦ä»å“ªä¸€ä¸ªé•œåƒä»“åº“æ‹‰å–é•œåƒï¼Œé€šå¸¸é€šè¿‡DNSæˆ–IPåœ°å€æ¥ç¡®å®šä¸€ä¸ªé•œåƒä»“åº“ï¼Œå¦‚hub.docker.com Repositoryï¼šç»„ç»‡åï¼Œå¦‚cncamp é•œåƒåç§°+æ ‡ç­¾ï¼šå¦‚nginxâˆ¶latest å…¬æœ‰é•œåƒä»“åº“ä¼˜åŠ¿
å¼€æ”¾ï¼šä»»ä½•å¼€å‘è€…éƒ½å¯ä»¥ä¸Šä¼ ã€åˆ†äº«é•œåƒåˆ°å…¬æœ‰é•œåƒä»“åº“ä¸­ã€‚
ä¾¿æ·ï¼šå¼€å‘è€…å¯ä»¥éå¸¸æ–¹ä¾¿åœ°æœç´¢ã€æ‹‰å–å…¶ä»–å¼€å‘è€…çš„é•œåƒï¼Œé¿å…é‡å¤é€ è½®å­ã€‚
å…è¿ç»´ï¼šå¼€å‘è€…åªéœ€è¦å…³æ³¨åº”ç”¨å¼€å‘ï¼Œä¸å¿…å…³å¿ƒé•œåƒä»“åº“çš„æ›´æ–°ã€å‡çº§ã€ç»´æŠ¤ç­‰ã€‚</description></item><item><title>ç”Ÿäº§åŒ–é›†ç¾¤çš„ç®¡ç†</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E7%94%9F%E4%BA%A7%E5%8C%96%E9%9B%86%E7%BE%A4%E7%9A%84%E7%AE%A1%E7%90%86/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E7%94%9F%E4%BA%A7%E5%8C%96%E9%9B%86%E7%BE%A4%E7%9A%84%E7%AE%A1%E7%90%86/</guid><description>è®¡ç®—èŠ‚ç‚¹ ç”Ÿäº§åŒ–é›†ç¾¤çš„è€ƒé‡ è®¡ç®—èŠ‚ç‚¹ï¼š å¦‚ä½•æ‰¹é‡å®‰è£…å’Œå‡çº§è®¡ç®—èŠ‚ç‚¹çš„æ“ä½œç³»ç»Ÿ? å¦‚ä½•ç®¡ç†é…ç½®è®¡ç®—èŠ‚ç‚¹çš„ç½‘ç»œä¿¡æ¯? å¦‚ä½•ç®¡ç†ä¸åŒSKUï¼ˆStockKeeping Unitï¼‰çš„è®¡ç®—èŠ‚ç‚¹? å¦‚ä½•å¿«é€Ÿä¸‹æ¶æ•…éšœçš„è®¡ç®—èŠ‚ç‚¹? å¦‚ä½•å¿«é€Ÿæ‰©ç¼©é›†ç¾¤çš„è§„æ¨¡? æ§åˆ¶å¹³é¢ï¼š å¦‚ä½•åœ¨ä¸»èŠ‚ç‚¹ä¸Šä¸‹è½½ã€å®‰è£…å’Œå‡çº§æ§åˆ¶å¹³é¢ç»„ä»¶åŠå…¶æ‰€éœ€çš„é…ç½®æ–‡ä»¶? å¦‚ä½•ç¡®ä¿é›†ç¾¤æ‰€éœ€çš„å…¶ä»–æ’ä»¶ï¼Œä¾‹å¦‚CoreDNSã€ç›‘æ§ç³»ç»Ÿç­‰éƒ¨ç½²å®Œæˆ? å¦‚ä½•å‡†å¤‡æ§åˆ¶å¹³é¢ç»„ä»¶çš„å„ç§å®‰å…¨è¯ä¹¦? å¦‚ä½•å¿«é€Ÿå‡çº§æˆ–å›æ»šæ§åˆ¶å¹³é¢ç»„ä»¶çš„ç‰ˆæœ¬? æ“ä½œç³»ç»Ÿçš„é€‰æ‹© æ“ä½œç³»ç»Ÿçš„è¯„ä¼°ä¸é€‰æ‹© é€šç”¨æ“ä½œç³»ç»Ÿ Ubuntu Centos Fedora ä¸“ä¸ºå®¹å™¨ä¼˜åŒ–çš„æ“ä½œç³»ç»Ÿ æœ€å°åŒ–æ“ä½œç³»ç»Ÿ CoreOS RedHat Atomic Snappy Ubuntu Core RancherOS æ“ä½œç³»ç»Ÿçš„è¯„ä¼°ä¸é€‰æ‹© æ“ä½œç³»ç»Ÿè¯„ä¼°å’Œé€‰å‹çš„æ ‡å‡†</description></item><item><title>è°ƒåº¦</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E8%B0%83%E5%BA%A6/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E8%B0%83%E5%BA%A6/</guid><description>kube-scheduler kube-schedulerè´Ÿè´£åˆ†é…è°ƒåº¦Pod åˆ°é›†ç¾¤å†…çš„èŠ‚ç‚¹ä¸Šï¼Œå®ƒç›‘å¬ kube-apiserverï¼ŒæŸ¥è¯¢è¿˜æœªåˆ†é…
Node çš„Podï¼Œç„¶åæ ¹æ®è°ƒåº¦ç­–ç•¥ä¸ºè¿™äº› Pod åˆ†é…èŠ‚ç‚¹ï¼ˆæ›´æ–° Pod çš„ NodeName å­—æ®µï¼‰ã€‚
è°ƒåº¦å™¨éœ€è¦å……åˆ†è€ƒè™‘è¯¸å¤šçš„å› ç´ âˆ¶
å…¬å¹³è°ƒåº¦ï¼› èµ„æºé«˜æ•ˆåˆ©ç”¨ï¼› QoSï¼› affinityå’Œ anti-affinityï¼› æ•°æ®æœ¬åœ°åŒ–ï¼ˆdata localityï¼‰ï¼› å†…éƒ¨è´Ÿè½½å¹²æ‰°ï¼ˆinter-workload interferenceï¼‰ï¼› deadlinesã€‚ è°ƒåº¦å™¨ kube-scheduler è°ƒåº¦åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œpredicate å’Œ priorityï¼š</description></item><item><title>è¿œç¨‹è°ƒè¯•</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95/</guid><description> åŸç†ï¼šhttps://learn.microsoft.com/zh-cn/visualstudio/bridge/overview-bridge-to-kubernetes
æ•™ç¨‹ï¼šhttps://learn.microsoft.com/zh-cn/visualstudio/bridge/bridge-to-kubernetes-vs-code
ç¤ºä¾‹ï¼šhttps://learn.microsoft.com/zh-cn/visualstudio/bridge/bridge-to-kubernetes-sample
å®‰è£… å®‰è£…vscode å®‰è£…vscodeæ‰©å±•Kuberneteså’ŒBridge to Kubernetes å®‰è£…goæ‰©å±• é…ç½® æ‰“å¼€é¡¹ç›® é€‰æ‹©kubernetes namespace æ‰“å¼€å‘½ä»¤é¢æ¿ï¼Œè¿è¡Œå‘½ä»¤â€œBridge to Kubernetes: é…ç½®â€ é€‰æ‹©éœ€è¦é‡å®šå‘åˆ°æœ¬åœ°çš„æœåŠ¡ è¾“å…¥æœ¬åœ°è¿è¡Œçš„ç¨‹åºçš„ç«¯å£å· é€‰æ‹©æˆ–åˆ›å»ºè°ƒè¯•çš„å¯åŠ¨é…ç½®ï¼ˆä¸æœ¬åœ°å¼€å‘çš„é…ç½®ç›¸åŒï¼‰ é€‰æ‹©åœ¨éš”ç¦»æˆ–ééš”ç¦»æ¨¡å¼ä¸‹è¿è¡Œï¼Œéš”ç¦»æ¨¡å¼éœ€è¦è½¬å‘header kubernetes-route-as åœ¨è°ƒè¯•ä¸­é€‰æ‹©åˆšæ‰åˆ›å»ºçš„é…ç½®å¯åŠ¨ é™åˆ¶ è¦ä½¿ Bridge to Kubernetes æˆåŠŸè¿æ¥ï¼Œä¸€ä¸ª pod åªèƒ½æœ‰ä¸€ä¸ªå®¹å™¨åœ¨è¯¥ pod ä¸­è¿è¡Œã€‚ ç›®å‰ï¼ŒBridge to Kubernetes pod å¿…é¡»æ˜¯ Linux å®¹å™¨ã€‚ ä¸æ”¯æŒ Windows å®¹å™¨ã€‚ Bridge to Kubernetes éœ€è¦æå‡çš„æƒé™æ‰èƒ½åœ¨å¼€å‘è®¡ç®—æœºä¸Šè¿è¡Œï¼Œä»¥ä¾¿ç¼–è¾‘ä¸»æœºæ–‡ä»¶ã€‚ Bridge to Kubernetes ä¸èƒ½ç”¨äºå·²å¯ç”¨ Azure Dev Spaces çš„ç¾¤é›†ã€‚</description></item><item><title>éƒ¨ç½²KubeSphere</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E9%83%A8%E7%BD%B2KubeSphere/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E9%83%A8%E7%BD%B2KubeSphere/</guid><description>å®‰è£…KubeSphere ç›´æ¥åœ¨k8sä¸­å®‰è£… 1 2 3 kubectl apply -f https://github.com/kubesphere/ks-installer/releases/download/v3.3.0/kubesphere-installer.yaml kubectl apply -f https://github.com/kubesphere/ks-installer/releases/download/v3.3.0/cluster-configuration.yaml æ£€æŸ¥å®‰è£…æ—¥å¿— kubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l 'app in (ks-install, ks-installer)' -o jsonpath='{.</description></item><item><title>é›†ç¾¤è”é‚¦å’ŒIstioå¤šé›†ç¾¤ç®¡ç†</title><link>https://obsidian.codeplayer.org/CS/Kubernetes/%E9%9B%86%E7%BE%A4%E8%81%94%E9%82%A6%E5%92%8CIstio%E5%A4%9A%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86/</link><pubDate>Sun, 09 Apr 2023 14:51:49 +0800</pubDate><guid>https://obsidian.codeplayer.org/CS/Kubernetes/%E9%9B%86%E7%BE%A4%E8%81%94%E9%82%A6%E5%92%8CIstio%E5%A4%9A%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86/</guid><description>é›†ç¾¤æ²»ç†çš„é©±åŠ¨åŠ› åˆ†å¸ƒå¼äº‘æ˜¯æœªæ¥ æˆæœ¬ä¼˜åŒ–ï¼ˆCost Effectiveï¼‰ æ›´å¥½çš„å¼¹æ€§åŠçµæ´»æ€§ï¼ˆElasticity&amp;amp;Flexibilityï¼‰ é¿å…å‚å•†é”å®šï¼ˆAvoid Vendor Lock-inï¼‰ ç¬¬ä¸€æ—¶é—´è·å–äº‘ä¸Šçš„æ–°åŠŸèƒ½ï¼ˆInnovationï¼‰ å®¹ç¾ï¼ˆResilience &amp;amp;Recoveryï¼‰ æ•°æ®ä¿æŠ¤åŠé£é™©ç®¡ç†ï¼ˆData Protection&amp;amp;Risk Managementï¼‰ æå‡å“åº”é€Ÿåº¦ï¼ˆNetworkPerformance Improvementsï¼‰ åˆ†å¸ƒå¼äº‘çš„æŒ‘æˆ˜ Kuberneteså•é›†ç¾¤æ‰¿è½½èƒ½åŠ›æœ‰é™ å¼‚æ„çš„åŸºç¡€è®¾æ–½ å­˜é‡èµ„æºæ¥å…¥ é…ç½®å˜æ›´åŠä¸‹å‘ è·¨åœ°åŸŸã€è·¨æœºæˆ¿åº”ç”¨éƒ¨ç½²åŠç®¡ç† å®¹ç¾ä¸éš”ç¦»æ€§ï¼Œå¼‚åœ°å¤šæ´» å¼¹æ€§è°ƒåº¦åŠè‡ªåŠ¨ä¼¸ç¼© ç›‘æ§å‘Šè­¦ å¦‚ä½•åº”å¯¹ é€šè¿‡Kubernetes å±è”½åº•å±‚åŸºç¡€è®¾æ–½ï¼Œæä¾›ç»Ÿä¸€çš„æ¥å…¥å±‚ å¤šäº‘æ¶æ„ å¤šé›†ç¾¤+å¤šäº‘ å¤šé›†ç¾¤ç®¡æ§ ç»Ÿä¸€çš„ç®¡æ§é¢ æ–¹ä¾¿æ¥å…¥ï¼Œé™ä½ä½¿ç”¨é—¨æ§› è·¨åœ°åŸŸçš„é›†ç¾¤ç®¡ç† é›†ç¾¤è”é‚¦ é›†ç¾¤è”é‚¦çš„å¿…è¦æ€§ å•ä¸€é›†ç¾¤çš„ç®¡ç†è§„æ¨¡æœ‰ä¸Šé™ æ•°æ®åº“å­˜å‚¨</description></item></channel></rss>